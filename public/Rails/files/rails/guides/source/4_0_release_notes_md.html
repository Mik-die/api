<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>4_0_release_notes.md</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../../../../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../../css/github.css" type="text/css" media="screen" />
<script src="../../../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>

</head>

<body>     
    <div class="banner">
        
        <h1>
            4_0_release_notes.md
        </h1>
        <ul class="files">
            <li>rails/guides/source/4_0_release_notes.md</li>
            <li>Last modified: 2013-04-26 19:51:18 +0300</li>
        </ul>
    </div>

    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<h1 id="label-Ruby+on+Rails+4.0+Release+Notes">Ruby on <a href="../../../../classes/Rails.html">Rails</a> 4.0 Release Notes</h1>

<p>Highlights in <a href="../../../../classes/Rails.html">Rails</a> 4.0:</p>
<ul><li>
<p>Ruby 2.0 preferred; 1.9.3+ required</p>
</li><li>
<p>Strong Parameters</p>
</li><li>
<p>Turbolinks</p>
</li><li>
<p>Russian Doll Caching</p>
</li></ul>

<p>These release notes cover only the major changes. To know about various bug
fixes and changes, please refer to the change logs or check out the <a
href="https://github.com/rails/rails/commits/master">list of commits</a> in
the main <a href="../../../../classes/Rails.html">Rails</a> repository on
GitHub.</p>
<hr style="height: 1px">

<h2 id="label-Upgrading+to+Rails+4.0">Upgrading to <a href="../../../../classes/Rails.html">Rails</a> 4.0</h2>

<p>If you&#39;re upgrading an existing application, it&#39;s a great idea to
have good test coverage before going in. You should also first upgrade to
<a href="../../../../classes/Rails.html">Rails</a> 3.2 in case you
haven&#39;t and make sure your application still runs as expected before
attempting an update to <a href="../../../../classes/Rails.html">Rails</a>
4.0. <a href="../../../../classes/A.html">A</a> list of things to watch out
for when upgrading is available in the <a
href="http://upgrading_ruby_on_rails.html#upgrading-from-rails-3-2-to-rails-4-0">Upgrading
to Rails</a> guide.</p>

<h2 id="label-Creating+a+Rails+4.0+application">Creating a <a href="../../../../classes/Rails.html">Rails</a> 4.0 application</h2>

<pre><code>You should have the &#39;rails&#39; rubygem installed
$ rails new myapp
$ cd myapp</code></pre>

<h3 id="label-Vendoring+Gems">Vendoring Gems</h3>

<p><a href="../../../../classes/Rails.html">Rails</a> now uses a
<code>Gemfile</code> in the application root to determine the gems you
require for your application to start. This <code>Gemfile</code> is
processed by the <a href="https://github.com/carlhuda/bundler">Bundler</a>
gem, which then installs all your dependencies. It can even install all the
dependencies locally to your application so that it doesn&#39;t depend on
the system gems.</p>

<p>More information: <a href="http://gembundler.com">Bundler homepage</a></p>

<h3 id="label-Living+on+the+Edge">Living on the <a href="../../../../classes/Edge.html">Edge</a></h3>

<p><code>Bundler</code> and <code>Gemfile</code> makes freezing your <a
href="../../../../classes/Rails.html">Rails</a> application easy as pie
with the new dedicated <code>bundle</code> command. If you want to bundle
straight from the Git repository, you can pass the <code>--edge</code>
flag:</p>

<pre><code>$ rails new myapp --edge</code></pre>

<p>If you have a local checkout of the <a
href="../../../../classes/Rails.html">Rails</a> repository and want to
generate an application using that, you can pass the <code>--dev</code>
flag:</p>

<pre><code>$ ruby /path/to/rails/railties/bin/rails new myapp --dev</code></pre>

<h2 id="label-Major+Features">Major Features</h2>

<p>TODO. Give a list and then talk about each of them briefly. We can point to
relevant code commits or documentation from these sections.</p>

<p><img src="http://images/rails4_features.png" /></p>

<h2 id="label-Extraction+of+features+to+gems">Extraction of features to gems</h2>

<p>In <a href="../../../../classes/Rails.html">Rails</a> 4.0, several features
have been extracted into gems. You can simply add the extracted gems to
your <code>Gemfile</code> to bring the functionality back.</p>
<ul><li>
<p>Hash-based &amp; Dynamic finder methods (<a
href="https://github.com/rails/activerecord-deprecated_finders">Github</a>)</p>
</li><li>
<p>Mass assignment protection in Active Record models (<a
href="https://github.com/rails/protected_attributes">Github</a>, <a
href="https://github.com/rails/rails/pull/7251">Pull Request</a>)</p>
</li><li>
<p>ActiveRecord::SessionStore (<a
href="https://github.com/rails/activerecord-session_store">Github</a>, <a
href="https://github.com/rails/rails/pull/7436">Pull Request</a>)</p>
</li><li>
<p>Active Record Observers (<a
href="https://github.com/rails/rails-observers">Github</a>, <a
href="https://github.com/rails/rails/commit/39e85b3b90c58449164673909a6f1893cba290b2">Commit</a>)</p>
</li><li>
<p>Active Resource (<a
href="https://github.com/rails/activeresource">Github</a>, <a
href="https://github.com/rails/rails/pull/572">Pull Request</a>, <a
href="http://yetimedia.tumblr.com/post/35233051627/activeresource-is-dead-long-live-activeresource">Blog</a>)</p>
</li><li>
<p>Action Caching (<a
href="https://github.com/rails/actionpack-action_caching">Github</a>, <a
href="https://github.com/rails/rails/pull/7833">Pull Request</a>)</p>
</li><li>
<p>Page Caching (<a
href="https://github.com/rails/actionpack-page_caching">Github</a>, <a
href="https://github.com/rails/rails/pull/7833">Pull Request</a>)</p>
</li><li>
<p>Sprockets (<a href="https://github.com/rails/sprockets-rails">Github</a>)</p>
</li><li>
<p>Performance tests (<a
href="https://github.com/rails/rails-perftest">Github</a>, <a
href="https://github.com/rails/rails/pull/8876">Pull Request</a>)</p>
</li></ul>

<h2 id="label-Documentation">Documentation</h2>
<ul><li>
<p>Guides are rewritten in GitHub Flavored Markdown.</p>
</li><li>
<p>Guides have a responsive design.</p>
</li></ul>

<h2 id="label-Railties">Railties</h2>

<p>Please refer to the <a
href="https://github.com/rails/rails/blob/master/railties/CHANGELOG.md">Changelog</a>
for detailed changes.</p>

<h3 id="label-Notable+changes">Notable changes</h3>
<ul><li>
<p>New test locations <code>test/models</code>, <code>test/helpers</code>,
<code>test/controllers</code>, and <code>test/mailers</code>. Corresponding
rake tasks added as well. (<a
href="https://github.com/rails/rails/pull/7878">Pull Request</a>)</p>
</li><li>
<p>Your app&#39;s executables now live in the <code>bin/</code> dir. Run
<code>rake rails:update:bin</code> to get <code>bin/bundle</code>,
<code>bin/rails</code>, and <code>bin/rake</code>.</p>
</li><li>
<p>Threadsafe on by default</p>
</li></ul>

<h3 id="label-Deprecations">Deprecations</h3>
<ul><li>
<p><code>config.threadsafe!</code> is deprecated in favor of
<code>config.eager_load</code> which provides a more fine grained control
on what is eager loaded.</p>
</li><li>
<p><code>Rails::Plugin</code> has gone. Instead of adding plugins to
<code>vendor/plugins</code> use gems or bundler with path or git
dependencies.</p>
</li></ul>

<h2 id="label-Action+Mailer">Action Mailer</h2>

<p>Please refer to the <a
href="https://github.com/rails/rails/blob/master/actionmailer/CHANGELOG.md">Changelog</a>
for detailed changes.</p>

<h3 id="label-Notable+changes">Notable changes</h3>

<h3 id="label-Deprecations">Deprecations</h3>

<h2 id="label-Active+Model">Active Model</h2>

<p>Please refer to the <a
href="https://github.com/rails/rails/blob/master/activemodel/CHANGELOG.md">Changelog</a>
for detailed changes.</p>

<h3 id="label-Notable+changes">Notable changes</h3>
<ul><li>
<p>Add <code>ActiveModel::ForbiddenAttributesProtection</code>, a simple
module to protect attributes from mass assignment when non-permitted
attributes are passed.</p>
</li><li>
<p>Added <code>ActiveModel::Model</code>, a mixin to make Ruby objects work
with AP out of box.</p>
</li></ul>

<h3 id="label-Deprecations">Deprecations</h3>

<h2 id="label-Active+Support">Active Support</h2>

<p>Please refer to the <a
href="https://github.com/rails/rails/blob/master/activesupport/CHANGELOG.md">Changelog</a>
for detailed changes.</p>

<h3 id="label-Notable+changes">Notable changes</h3>
<ul><li>
<p>Replace deprecated <code>memcache-client</code> gem with <code>dalli</code>
in <a
href="../../../../classes/ActiveSupport/Cache/MemCacheStore.html">ActiveSupport::Cache::MemCacheStore</a>.</p>
</li><li>
<p>Optimize ActiveSupport::Cache::Entry to reduce memory and processing
overhead.</p>
</li><li>
<p>Inflections can now be defined per locale. <code>singularize</code> and
<code>pluralize</code> accept locale as an extra argument.</p>
</li><li>
<p><code>Object#try</code> will now return nil instead of raise a
NoMethodError if the receiving object does not implement the method, but
you can still get the old behavior by using the new
<code>Object#try!</code>.</p>
</li></ul>

<h3 id="label-Deprecations">Deprecations</h3>
<ul><li>
<p>Deprecate <code>ActiveSupport::TestCase#pending</code> method, use
<code>skip</code> from <a
href="../../../../classes/MiniTest.html">MiniTest</a> instead.</p>
</li><li>
<p><a
href="../../../../classes/ActiveSupport/Benchmarkable.html#method-i-silence">ActiveSupport::Benchmarkable#silence</a>
has been deprecated due to its lack of thread safety. It will be removed
without replacement in <a href="../../../../classes/Rails.html">Rails</a>
4.1.</p>
</li><li>
<p><code>ActiveSupport::JSON::Variable</code> is deprecated. Define your own
<code>#as_json</code> and <code>#encode_json</code> methods for custom JSON
string literals.</p>
</li><li>
<p>Deprecates the compatibility method <a
href="../../../../classes/Module.html#method-i-local_constant_names">Module#local_constant_names</a>,
use Module#local_constants instead (which returns symbols).</p>
</li><li>
<p>BufferedLogger is deprecated. Use <a
href="../../../../classes/ActiveSupport/Logger.html">ActiveSupport::Logger</a>,
or the logger from Ruby stdlib.</p>
</li><li>
<p>Deprecate <code>assert_present</code> and <code>assert_blank</code> in
favor of <code>assert object.blank?</code> and <code>assert
object.present?</code></p>
</li></ul>

<h2 id="label-Action+Pack">Action Pack</h2>

<p>Please refer to the <a
href="https://github.com/rails/rails/blob/master/actionpack/CHANGELOG.md">Changelog</a>
for detailed changes.</p>

<h3 id="label-Notable+changes">Notable changes</h3>
<ul><li>
<p>Change the stylesheet of exception pages for development mode. Additionally
display also the line of code and fragment that raised the exception in all
exceptions pages.</p>
</li></ul>

<h3 id="label-Deprecations">Deprecations</h3>

<h2 id="label-Active+Record">Active Record</h2>

<p>Please refer to the <a
href="https://github.com/rails/rails/blob/master/activerecord/CHANGELOG.md">Changelog</a>
for detailed changes.</p>

<h3 id="label-Notable+changes">Notable changes</h3>
<ul><li>
<p>Improve ways to write <code>change</code> migrations, making the old
<code>up</code> &amp; <code>down</code> methods no longer necessary.</p>
<ul><li>
<p>The methods <code>drop_table</code> and <code>remove_column</code> are now
reversible, as long as the necessary information is given.  The method
<code>remove_column</code> used to accept multiple column names; instead
use <code>remove_columns</code> (which is not revertible).  The method
<code>change_table</code> is also reversible, as long as its block
doesn&#39;t call <code>remove</code>, <code>change</code> or
<code>change_default</code></p>
</li><li>
<p>New method <code>reversible</code> makes it possible to specify code to be
run when migrating up or down.  See the <a
href="https://github.com/rails/rails/blob/master/guides/source/migrations.md#using-the-reversible-method">Guide
on Migration</a></p>
</li><li>
<p>New method <code>revert</code> will revert a whole migration or the given
block.  If migrating down, the given migration / block is run normally. 
See the <a
href="https://github.com/rails/rails/blob/master/guides/source/migrations.md#reverting-previous-migrations">Guide
on Migration</a></p>
</li></ul>
</li><li>
<p>Adds some metadata columns to <code>schema_migrations</code> table.</p>
<ul><li>
<p><code>migrated_at</code></p>
</li><li>
<p><code>fingerprint</code> - an md5 hash of the migration.</p>
</li><li>
<p><code>name</code> - the filename minus version and extension.</p>
</li></ul>
</li><li>
<p>Adds PostgreSQL array type support. Any datatype can be used to create an
array column, with full migration and schema dumper support.</p>
</li><li>
<p>Add <code>Relation#load</code> to explicitly load the record and return
<code>self</code>.</p>
</li><li>
<p><code>Model.all</code> now returns an <code>ActiveRecord::Relation</code>,
rather than an array of records. Use <code>Relation#to_a</code> if you
really want an array. In some specific cases, this may cause breakage when
upgrading.</p>
</li><li>
<p>Added <code>ActiveRecord::Migration.check_pending!</code> that raises an
error if migrations are pending.</p>
</li><li>
<p>Added custom coders support for <code>ActiveRecord::Store</code>. Now you
can set your custom coder like this:</p>

<pre><code>store :settings, accessors: [ :color, :homepage ], coder: JSON</code></pre>
</li><li>
<p><code>mysql</code> and <code>mysql2</code> connections will set
<code>SQL_MODE=STRICT_ALL_TABLES</code> by default to avoid silent data
loss. This can be disabled by specifying <code>strict: false</code> in your
<code>database.yml</code>.</p>
</li><li>
<p>Remove IdentityMap.</p>
</li><li>
<p>Remove automatic execution of EXPLAIN queries. The option
<code>active_record.auto_explain_threshold_in_seconds</code> is no longer
used and should be removed.</p>
</li><li>
<p>Adds <code>ActiveRecord::NullRelation</code> and
<code>ActiveRecord::Relation#none</code> implementing the null object
pattern for the Relation class.</p>
</li><li>
<p>Added <code>create_join_table</code> migration helper to create HABTM join
tables.</p>
</li><li>
<p>Allows PostgreSQL hstore records to be created.</p>
</li></ul>

<h3 id="label-Deprecations">Deprecations</h3>
<ul><li>
<p>Deprecated the old-style hash based finder API. This means that methods
which previously accepted "finder options" no longer do.</p>
</li><li>
<p>All dynamic methods except for <code>find_by_...</code> and
<code>find_by_...!</code> are deprecated. Here&#39;s how you can rewrite
the code:</p>
<ul><li>
<p><code>find_all_by_...</code> can be rewritten using
<code>where(...)</code>.</p>
</li><li>
<p><code>find_last_by_...</code> can be rewritten using
<code>where(...).last</code>.</p>
</li><li>
<p><code>scoped_by_...</code> can be rewritten using <code>where(...)</code>.</p>
</li><li>
<p><code>find_or_initialize_by_...</code> can be rewritten using
<code>where(...).first_or_initialize</code>.</p>
</li><li>
<p><code>find_or_create_by_...</code> can be rewritten using
<code>find_or_create_by(...)</code> or
<code>where(...).first_or_create</code>.</p>
</li><li>
<p><code>find_or_create_by_...!</code> can be rewritten using
<code>find_or_create_by!(...)</code> or
<code>where(...).first_or_create!</code>.</p>
</li></ul>
</li></ul>

<h2 id="label-Credits">Credits</h2>

<p>See the <a href="http://contributors.rubyonrails.org/">full list of
contributors to Rails</a> for the many people who spent many hours making
<a href="../../../../classes/Rails.html">Rails</a>, the stable and robust
framework it is. Kudos to all of them.</p>

    </div>
  


  


  
  


  


  

  



  

    

    

    


    


    <!-- Methods -->
              </div>

    </div>
  </body>
</html>